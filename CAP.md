# CAP теорема для MongoDB, PostgreSQL, Cassandra
## MongoDB

1. Consistency (Согласованность) – MongoDB обеспечивает согласованность, так как операции записи и чтения используют механизм репликации с подтверждением (Write Concern). Это означает, что данные будут читаться так, как они были записаны.

2. Availability (Доступность) – MongoDB может жертвовать доступностью в условиях разделения сети (network partition). Если основная нода в кластере недоступна, запись может заблокироваться до выбора нового лидера.

3. Partition Tolerance (Устойчивость к разделению сети) – MongoDB устойчив к разделению сети, так как поддерживает репликацию и распределенные механизмы управления отказами

Также MongoDB настраивается разными способами:

* Если используется Write Concern = "majority", то MongoDB обеспечивает CP.
* Если разрешены чтения с вторичных реплик и слабая консистентность (Read Concern = "available"), то MongoDB приближается к AP.

Таким образом, MongoDB в основном относится к CP, но его поведение можно настраивать.

## PostgreSQL

1. Consistency (Согласованность) – PostgreSQL обеспечивает строгую согласованность транзакций благодаря ACID-свойствам и механизму MVCC (Multi-Version Concurrency Control).

2. Availability (Доступность) – Если сервер работает без сбоев, то он всегда доступен для запросов.

3. Partition Tolerance (Устойчивость к разделению сети) - В классическом варианте Standalone PostgreSQL не расчитан на разделение нескольких нод. В варианте с использованием HA кластера с репликами (patroni, etcd) ноды могут стать недоступными на момент выбора нового лидера либо для синхронизации реплики.

В классическом Standalone варианте PostgreSQL ближе к CA, в кластерном варианте с репликами ближе к CP

## Cassandra

Apache Cassandra обычно классифицируется как AP-система по CAP-теореме. Это означает, что при возникновении разделения сети Cassandra отдает приоритет доступности (Availability) и устойчивости к разделениям сети (Partition Tolerance), жертвуя строгой синхронной согласованностью (Consistency).

1. Consistency (Согласованность) - место жесткой согласованности Cassandra реализует модель eventual consistency – данные могут быть временно рассогласованы, но со временем все реплики придут к единому значению. При этом можно настраивать уровень согласованности посредством параметров (consistency levels) для отдельных операций, что позволяет повысить согласованность за счет некоторого снижения доступности.

2. Availability (Доступность) и  Partition Tolerance (Устойчивость к разделению сети) - Cassandra разработана для работы в распределённой среде, где сеть может быть ненадежной. Система продолжает обслуживать запросы даже при наличии сбоев в коммуникации между узлами, что соответствует принципам AP.

Apache Cassandra – это AP-система, которая выбирает высокую доступность и устойчивость к разделениям сети, даже если это означает, что данные могут быть не полностью согласованы в режиме реального времени.